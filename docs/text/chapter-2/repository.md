# リポジトリ

前編で説明したブランチの仕組みだけでも個人開発や小規模な共同開発では十分ですが、大規模な共同開発に供するには心許ない節があります。なぜなら、多少便利さが付加されたにしろ、この仕組みは今のところ「変更の履歴が残るクラウドストレージ」であるに過ぎないからです。

## 共同開発とブランチ

共同開発ではプロダクトの複数の部分のそれぞれで同時に開発が進むことが一般的です。1 本のブランチの中に各部分の変更のコミットが入り乱れると当然コミットグラフは見にくくなりますが、問題はそれだけではありません。

:::tip Web 開発と 1 本のブランチ
Web アプリの開発において、一般的には **フロントエンド**（ユーザーが直接見える部分）と **バックエンド**（データの授受と保管）をそれぞれ複数人で開発していくことになります。フロントエンドを開発するにはバックエンドが正しく動いている必要があります。フロントエンドは Web ページにデータをどう表示するかの部分を担いますが、肝心のデータ（画像やテキスト）がバックエンドから送られてこなければ Web ページの表示は見るも無惨に崩れてしまいます。

ここで、バックエンドのシステムに大きな変更が必要になったとしましょう。変更途中には当然バックエンドは不完全であり、全く動かない可能性もあります。この場合、バックエンドの担当が優しければフロントエンドの開発を妨げないためにブランチの外側で（Git に頼らず）開発をすることになりそうです。もしバックエンドが譲らない場合、フロントエンドの担当は正しく動く過去のバックエンドをもとにブランチの外側で開発することになります。いずれにせよ、1 本のブランチの上に複数の部分の開発を共存させることは多大な困難を伴います。
:::

この問題を解決するために、Git ではブランチから別のブランチを「**生やす**」ことができます。ブランチ（枝）という名前から予測できたでしょうが、この機能が Git を便利なツールたらしめる最重要要素です。

## リポジトリ

長らく「リポジトリ」という言葉を説明なしに用いてきました。リポジトリとは **ある共通の根を持つブランチの集合** を表します。ブランチ一つ一つは「根っこの状態」と「その後のひとつひとつの変更」の情報を持っていて、必要に応じてブランチを生やしたり（なぜか「切る」という逆の意味っぽい言葉を使うこともあります）、ブランチの変更を別のブランチに反映させたりすることができます。

リポジトリは一般に以下のように運用されています。

- main ブランチを常にシステムとして健全に動くようにしておく
- main ブランチから「変更のブランチ」を生やし、その中で変更を済ませて main に反映

これによって、他の部分が健全に動くことが保証された状態で各部分の開発に取り組むことができるようになりまあす。大規模なプロジェクトでも、このリポジトリ・ブランチの仕組みがあれば十分に回るというわけです。

:::tip モノリポとポリリポ
ところが、共同開発を強力に支えるこのリポジトリの仕組みを以てしても管理が追いつかなくなるような規模のプロジェクトは少なからず存在します。一つのプロジェクトを一つのリポジトリにおさめて管理することを「モノリポ」と呼び、それ自体が「ポリリポ」と呼ばれる対照的な管理形態の存在を暗示しています。

一つのプロジェクトを複数のリポジトリで分割して管理することにはいくつかメリットがあります。たとえば、開発者の権限はリポジトリごとに与えられるので、開発者が変更可能な領域を明確にできるという意味ではポリリポは良い選択です。

traP のプロジェクトとしては例えば traQ がポリリポを採用していて、フロントエンド（[traQ_S-UI](https://github.com/traPtitech/traQ_S-UI)）とバックエンド（[traQ](https://github.com/traPtitech/traQ)）の 2 つのリポジトリに分かれています。ただしフロントエンドとバックエンドを単一のリポジトリに収めるモノリポも珍しいものではなく、とくに開発初期段階では互いに API 仕様などの擦り合わせをしつつ開発を進めていくためにモノリポの方が都合がよいことが多いです。モノリポとポリリポのどちらにも他方より良い点があり、評価の要は個人がリポジトリを跨いで開発をすることの難しさをメリットと捉えるか、デメリットと捉えるかです。
:::