# 共同開発の基本

多くの場合、共同開発における個人の作業は以下の繰り返しです。

1. **main からブランチを生やす**
2. **ブランチ内でコミットをしていく**
3. **変更が済んだらプルリクエストを出す**
4. **main にマージする**

ここまでの操作で全て体験できましたね。この章ではそれぞれの操作の意味を説明します。

## プルリクエスト

**プルリクエスト**（Pull Request, PR）という機能はバージョン管理ツールとしての Git 自体には存在せず、GitHub や Gitea などのホスティングサービスの側が提供しています。変更を直接 main にマージするのではなく、変更点に問題がなさそうか、みんなの審判を問うためのワンクッションです。

:::warning プルリクエストは「プルのリクエスト」ではない
プルリクエストの趣旨は「このブランチを main に **マージ** してほしい」であって、その先の「このブランチがマージされたら各自で main を **プル** してほしい」ではありません。歴史的経緯から「プルリクエスト」という名前で今まで通ってきたものの、ややこしいという指摘は未だに受け続けているようです。GitHub や Gitea では「プルリクエスト」と呼ばれていますが、他の著名なホスティングサービスの一つである GitLab では「マージリクエスト」というより直感的な表現が使われています。
:::

プルやマージという言葉には前編で説明した以上の意味があることがお分かりになるかと思います。マージは「**ある期間にブランチでコミットされた変更をまとめて別のブランチに反映させること**」全般を表します。今回の場合は、sub ブランチを生やしてからの sub ブランチの変更全てを main ブランチに反映させています。

:::warning マージは「統合」ではない
「sub の変更を main にマージ」した直後でも sub と main が全く同じ状態になるとは限らないことに注意が必要です。ブランチが保存する情報は「**変更**」なので、「sub の変更」以外の部分は main には影響を与えません。

![](https://md.trap.jp/uploads/upload_8b27e59a114f984bf7c41d456dc95b40.png)
<p style="font-size: 12px; text-align: center; margin: -8px 0 0 0">sub をマージしてもファイル A の状態が戻るわけではない</p>
:::

ブランチが途中で生えたりマージされたりするとコミットグラフはこんな感じになります。

![](https://md.trap.jp/uploads/upload_8354df7754459cfd08b0e67b333e8b19.png)

:::tip ブランチという命名について
そもそも、ほとんどの場合「あとで main にマージする」ために生やすものを「木の枝（ブランチ）」と呼ぶのもちょっと変な話ではありますね。上の図のようにブランチがマージしてしまったら、コミットグラフは少なくともグラフ理論における「木」の定義には当てはまらないものになります。とはいえ、代案を考えろと言われても…。
:::

## そのほかの概念

Gitea をはじめとするホスティングサービスは開発を便利にするために色々な機能を提供しています。これらはバージョン管理ツールである Git には存在しない機能です。

- **Issue** ... Gitea や GitHub では、そのプロダクトについて「現状の問題点」とか「やるべきこと」をメモ・共有するために Issue を立てる機能があります。Issue にはその問題点の性質を示すタグをつけることができます。[traQ フロントエンドリポジトリ の Issues](https://github.com/traPtitech/traQ_S-UI/issues) を見るとこの機能の意義が掴めると思います。

- **レビュー** ... 立てられたプルリクエストにおける変更に問題がなさそうかを検証することです。Gitea 上でもレビューをするための UI や機能が提供されていて、1 人以上の Approve がなければプルリクエストのマージができないような設定にすることもできます。