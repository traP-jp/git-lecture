# コンフリクトの解決

ひとつのファイルを互いに同期される前に別々の方法で書き換えると **コンフリクト**（競合）が生じます。出会いがちなパターン 2 つについて、試せる解決方法を記します。

## マージ競合

mydrive リポジトリで main ブランチから sub ブランチを生やしたとします。main ブランチと sub ブランチのそれぞれで異なる内容で README.md を変更してコミットしたのち、sub ブランチを main にマージしようとするとコンフリクトが生じます。

コンフリクトが発覚するのはプルリクエストを出した直後の Gitea の画面上です。

![]()

集団開発で起きやすいコンフリクトです。指示に従うと以下のような画面に飛び、Gitea 上でコンフリクトを解決することになります。

![]()

競合が発生している箇所が「<<<<<<<」や「>>>>>>>」で囲まれて表示されるので、ファイル全体を最終的に欲しい状態に直してから「」を押します。

![]()

## ローカル環境間の同期競合

デスクトップディレクトリとダウンロードディレクトリの mydrive がともに main ブランチにいるとします。デスクトップ の mydrive で README.md を変更してコミットしたのち、ダウンロードの mydrive で「変更を同期」する前に README.md を変更してコミットしようとするとコンフリクトが生じます。

コンフリクトが発覚するのは VSCode 上で「コミット」ボタンを押した瞬間です。

![]()

main ブランチに直接コミットしながら個人開発をしている時に起きやすいコンフリクトです。この場合はマージ競合のように専用の競合解決画面が用意されているわけではなさそうです。こまめなコミットを心がけていれば競合は軽微なもので済むので、どちらかを完全に押し通してしまうのが手っ取り早い解決かも知れません。

今開いているエディタでの変更をなかったことにするには、以下を実行します。

```sh
$ git fetch origin
$ git reset --hard origin/main
$ git clean -fd
```

今開いているエディタでの変更を押し通すには、以下を実行します。

```sh
$ git push origin main --force
```

:::danger
この部分の記述には全く自信がないので、あとで校正を入れます！
:::

---

共同開発でしっかり各々の役割分けがなされている場合、それぞれで変更を加えるファイルが異なるのでコンフリクトに出会うことは稀です。もし出会ってしまったら自分で解決しようとするより Git に詳しいチームメイトに助けを求めるのが手っ取り早い解決方法かも知れません。